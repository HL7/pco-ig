@prefix fhir: <http://hl7.org/fhir/> .
@prefix loinc: <https://loinc.org/rdf/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# - resource -------------------------------------------------------------------

<http://mtnlotus.com/uv/pco/Measure/PHQ9MeasureExample> a fhir:Measure ;
  fhir:nodeRole fhir:treeRoot ;
  fhir:id [ fhir:v "PHQ9MeasureExample"] ; # 
  fhir:meta [
     fhir:profile ( [
       fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/computable-measure-cqfm"^^xsd:anyURI ;
       fhir:link <http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/computable-measure-cqfm>
     ] )
  ] ; # 
  fhir:text [
     fhir:status [ fhir:v "extensions" ] ;
     fhir:div "<div xmlns=\"http://www.w3.org/1999/xhtml\">\n    <table class=\"grid dict\">\n        \n            <tr>\n                <th scope=\"row\"><b>Title: </b></th>\n                <td style=\"padding-left: 4px;\">PHQ-9 Measure Example</td>\n            </tr>\n        \n\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Id: </b></th>\n                <td style=\"padding-left: 4px;\">PHQ9MeasureExample</td>\n            </tr>\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Version: </b></th>\n                <td style=\"padding-left: 4px;\">0.1.0</td>\n            </tr>\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Url: </b></th>\n                <td style=\"padding-left: 4px;\"><a href=\"Measure-PHQ9MeasureExample.html\">PHQ-9 Measure Example</a></td>\n            </tr>\n        \n\n        \n\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Status: </b></th>\n                <td style=\"padding-left: 4px;\">draft</td>\n            </tr>\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Experimental: </b></th>\n                <td style=\"padding-left: 4px;\">true</td>\n            </tr>\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Publisher: </b></th>\n                <td style=\"padding-left: 4px;\">Mountain Lotus WellBeing LLC</td>\n            </tr>\n        \n\n        \n\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Description: </b></th>\n                <td style=\"padding-left: 4px;\"><div><p>Example measure illustrating a continuous variable measure calculating scores from multiple questionnaires</p>\n</div></td>\n            </tr>\n        \n\n        \n\n        \n\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Jurisdiction: </b></th>\n                <td style=\"padding-left: 4px;\">001</td>\n            </tr>\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Scoring: </b></th>\n                <td style=\"padding-left: 4px;\">\n                    \n                        \n                            <p style=\"margin-bottom: 5px;\">\n                                <span>Continuous Variable </span>\n                            </p>\n                        \n                    \n                    \n                </td>\n            </tr>\n        \n\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Type: </b></th>\n                <td style=\"padding-left: 4px;\">\n                    \n                        \n                            <p style=\"margin-bottom: 5px;\">\n                                <span>process </span>\n                            </p>\n                        \n                    \n                    \n                </td>\n            </tr>\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Improvement Notation: </b></th>\n                <td style=\"padding-left: 4px;\">\n                    \n                        \n                            <p style=\"margin-bottom: 5px;\">\n                                <span>increase </span>\n                            </p>\n                        \n                    \n                    \n                </td>\n            </tr>\n        \n\n        \n\n        \n            \n        \n\n        \n\n        \n\n        \n\n        \n            <tr>\n                <th scope=\"row\"><b>Libraries: </b></th>\n                <td style=\"padding-left: 4px;\">\n                    <table class=\"grid-dict\">\n                        \n                            <tr>\n                                <td><a href=\"Library-PHQ9MeasureExample.html\">PHQ9MeasureExample</a></td>\n                            </tr>\n                        \n                    </table>\n                </td>\n            </tr>\n        \n\n        \n\n        \n            \n                <tr>\n                    <th scope=\"row\"><b>Terminology and Other Dependencies: </b></th>\n                    <td style=\"padding-left: 4px;\">\n                        \n                            <li><a href=\"Library-PHQ9ScoreLogic.html\">PHQ9ScoreLogic</a></li>\n                        \n                            <li><code>http://mtnlotus.com/uv/pco/Library/FHIRHelpers|4.0.1</code></li>\n                        \n                            <li><a href=\"http://terminology.hl7.org/6.0.2/CodeSystem-v3-loinc.html\">Logical Observation Identifiers, Names and Codes (LOINC)</a></li>\n                        \n                    </td>\n                </tr>\n                <tr>\n                    <th scope=\"row\"><b>Parameters:</b></th>\n                    <td style=\"padding-left: 4px;\">\n                        <table class=\"grid-dict\">\n                            <tr>\n                                <th><b>name</b></th>\n                                <th><b>use</b></th>\n                                <th><b>min</b></th>\n                                <th><b>max</b></th>\n                                <th><b>type</b></th>\n                            </tr>\n                            \n                                <tr>\n                                    <td>Measurement Period</td>\n                                    <td>In</td>\n                                    <td>0</td>\n                                    <td>1</td>\n                                    <td>Period</td>\n                                </tr>\n                            \n                                <tr>\n                                    <td>Initial Population</td>\n                                    <td>Out</td>\n                                    <td>0</td>\n                                    <td>1</td>\n                                    <td>boolean</td>\n                                </tr>\n                            \n                                <tr>\n                                    <td>Measure Population</td>\n                                    <td>Out</td>\n                                    <td>0</td>\n                                    <td>1</td>\n                                    <td>boolean</td>\n                                </tr>\n                            \n                        </table>\n                    </td>\n                </tr>\n\n                <tr>\n                    <th scope=\"row\"><b>DataRequirements:</b></th>\n                    <td style=\"padding-left: 4px;\">\n                        <table class=\"grid-dict\">\n                            <tr>\n                                <th><b>Resource Type</b></th>\n                                <th><b>Resource Elements</b></th>\n                                <th><b>Valueset Name</b></th>\n                                <th><b>Valueset</b></th>\n                            </tr>\n                            \n                                <tr>\n                                    <td>Patient(<a href=\"http://hl7.org/fhir/R4/patient.html\">Patient</a>)</td>\n                                    <td>\n                                        \n                                    </td>\n                                    <td>\n                                        \n                                    </td>\n                                    <td/>\n                                </tr>\n                            \n                        </table>\n                    </td>\n                </tr>\n\n                \n                    <tr>\n                        <th scope=\"row\"><b>Direct Reference Codes:</b></th>\n                        <td style=\"padding-left: 4px;\">\n                            <table class=\"grid-dict\">\n                                <tr>\n                                    <th><b>display</b></th>\n                                    <th><b>code</b></th>\n                                    <th><b>system</b></th>\n                                </tr>\n                                \n                                    <tr>\n                                        <td/>\n                                        <td>LA6568-5</td>\n                                        <td><a href=\"http://terminology.hl7.org/6.0.2/CodeSystem-v3-loinc.html\">http://loinc.org</a></td>\n                                    </tr>\n                                \n                                    <tr>\n                                        <td/>\n                                        <td>LA6569-3</td>\n                                        <td><a href=\"http://terminology.hl7.org/6.0.2/CodeSystem-v3-loinc.html\">http://loinc.org</a></td>\n                                    </tr>\n                                \n                                    <tr>\n                                        <td/>\n                                        <td>LA6570-1</td>\n                                        <td><a href=\"http://terminology.hl7.org/6.0.2/CodeSystem-v3-loinc.html\">http://loinc.org</a></td>\n                                    </tr>\n                                \n                                    <tr>\n                                        <td/>\n                                        <td>LA6571-9</td>\n                                        <td><a href=\"http://terminology.hl7.org/6.0.2/CodeSystem-v3-loinc.html\">http://loinc.org</a></td>\n                                    </tr>\n                                \n                            </table>\n                        </td>\n                    </tr>\n                \n\n                \n                <tr>\n                    <th scope=\"row\"><b>Logic Definitions:</b></th>\n                    <td style=\"padding-left: 4px;\">\n                        \n                        <table class=\"grid-dict\">\n                            <tr>\n                                <th><b>Group</b></th>\n                                <th><b>Scoring</b></th>\n                                <th><b>Population Criteria</b></th>\n                                <th><b>Expression</b></th>\n                            </tr>\n                            <tr>\n                                \n                                <td> group-1 </td>\n                                <td colspan=\"3\" style=\"padding-left: 4px;\">\n                                    \n\n                                    \n\n                                    \n                                        <b>Measure scoring:</b>\n                                        \n                                            <p style=\"margin-bottom: 5px;\">\n                                                <span>Continuous Variable</span>\n                                            </p>\n                                        \n                                    \n\n                                    \n\n                                    \n\n                                    \n\n                                    \n\n                                    \n\n                                    \n\n                                </td>\n                                \n                                <tr>\n                                    <td/>\n                                    <td/>\n                                    <td>Initial Population</td>\n                                    <td>\n                                        \n                                            <pre><code class=\"language-cql\">define &quot;Initial Population&quot;:\n  AgeInYearsAt(start of &quot;Measurement Period&quot;) &gt;= 18</code></pre>\n                                        \n                                    </td>\n                                </tr>\n                                \n                                <tr>\n                                    <td/>\n                                    <td/>\n                                    <td>Measure Population</td>\n                                    <td>\n                                        \n                                            <pre><code class=\"language-cql\">// Likely some condition or other relevant characteristic such as a depression diagnosis\ndefine &quot;Measure Population&quot;:\n  true</code></pre>\n                                        \n                                    </td>\n                                </tr>\n                                \n                                <tr>\n                                    <td/>\n                                    <td/>\n                                    <td>Measure Observation</td>\n                                    <td>\n                                        \n                                            <pre><code class=\"language-cql\">/*\nMeasure observation is a function defined in terms of the types of members of the measure\npopulation, Patient in this case. In a population evaluation scenario, the measure\nobservation is evaluated for every member of the population.\n\nIn an individual report scenario, however, the measure observation is evaluated for\nthe current patient. Note that the patient context is flowing through the call here\n*/\ndefine function &quot;MeasureObservation&quot;(patient Patient):\n  PHQ9Logic.CalculateTotalScore</code></pre>\n                                        \n                                    </td>\n                                </tr>\n                                \n                                \n                            \n                            </tr>\n                        </table>\n                \n\n                <table class=\"grid-dict\">\n                    \n                        <tr>\n                            <th><b>Library Name</b></th>\n                            <th><b>Name</b></th>\n                        </tr>\n                        <tr>\n                            \n                                <td>PHQ9ScoreLogic</td>\n                            \n                            \n                                <td>QuestionnaireResponse</td>\n                            \n                        </tr>\n                        <tr>\n                            \n                                <td/>\n                                <td>\n                                    <pre class=\"highlight language-cql\"><code class=\"language-cql\">// Use the QuestionnaireResponse provided as a parameter if available\n// Otherwise look it up from the record\ndefine &quot;QuestionnaireResponse&quot;:\n  if response is not null then\n    response\n  else\n    Last(\n      [QuestionnaireResponse] QR\n        where QR.questionnaire = 'http://loinc.org/q/44249-1'\n        sort by (authored as FHIR.dateTime) desc\n    )</code></pre>\n                                </td>\n                            \n                        </tr>\n                    \n                        <tr>\n                            <th><b>Library Name</b></th>\n                            <th><b>Name</b></th>\n                        </tr>\n                        <tr>\n                            \n                                <td>PHQ9ScoreLogic</td>\n                            \n                            \n                                <td>Responses</td>\n                            \n                        </tr>\n                        <tr>\n                            \n                                <td/>\n                                <td>\n                                    <pre class=\"highlight language-cql\"><code class=\"language-cql\">// NOTE: This ties this logic directly to this particular rendering of the Questionnaire.\n// Ideally the items would be filtered based on Code of the Item, rather than the LinkId,\n// but that would require pulling in the Questionnaire because the QuestionnaireResponse\n// only has the LinkId.\ndefine &quot;Responses&quot;:\n  &quot;QuestionnaireResponse&quot; QR\n    return QR.item I where I.linkId in {\n      '14363', //'LittleInterest'\n      '14364', //'FeelingDown'\n      '14365', //'TroubleSleeping'\n      '14366', //'FeelingTired'\n      '14367', //'BadApetite'\n      '14368', //'FeelingBadAboutSelf'\n      '14369', //'TroubleConcetrating'\n      '14370' //'MovingSpeaking'\n      // '14371' // HurtingSelf\n    }</code></pre>\n                                </td>\n                            \n                        </tr>\n                    \n                        <tr>\n                            <th><b>Library Name</b></th>\n                            <th><b>Name</b></th>\n                        </tr>\n                        <tr>\n                            \n                                <td>PHQ9ScoreLogic</td>\n                            \n                            \n                                <td>CalculateTotalScore</td>\n                            \n                        </tr>\n                        <tr>\n                            \n                                <td/>\n                                <td>\n                                    <pre class=\"highlight language-cql\"><code class=\"language-cql\">define &quot;CalculateTotalScore&quot;:\n  Sum(&quot;Responses&quot; R return all AnswerCardinality(First(R.answer.value)))</code></pre>\n                                </td>\n                            \n                        </tr>\n                    \n                        <tr>\n                            <th><b>Library Name</b></th>\n                            <th><b>Name</b></th>\n                        </tr>\n                        <tr>\n                            \n                                <td>PHQ9MeasureExample</td>\n                            \n                            \n                                <td>Initial Population</td>\n                            \n                        </tr>\n                        <tr>\n                            \n                                <td/>\n                                <td>\n                                    <pre class=\"highlight language-cql\"><code class=\"language-cql\">define &quot;Initial Population&quot;:\n  AgeInYearsAt(start of &quot;Measurement Period&quot;) &gt;= 18</code></pre>\n                                </td>\n                            \n                        </tr>\n                    \n                        <tr>\n                            <th><b>Library Name</b></th>\n                            <th><b>Name</b></th>\n                        </tr>\n                        <tr>\n                            \n                                <td>PHQ9MeasureExample</td>\n                            \n                            \n                                <td>Measure Population</td>\n                            \n                        </tr>\n                        <tr>\n                            \n                                <td/>\n                                <td>\n                                    <pre class=\"highlight language-cql\"><code class=\"language-cql\">// Likely some condition or other relevant characteristic such as a depression diagnosis\ndefine &quot;Measure Population&quot;:\n  true</code></pre>\n                                </td>\n                            \n                        </tr>\n                    \n                        <tr>\n                            <th><b>Library Name</b></th>\n                            <th><b>Name</b></th>\n                        </tr>\n                        <tr>\n                            \n                                <td>PHQ9MeasureExample</td>\n                            \n                            \n                                <td>MeasureObservation</td>\n                            \n                        </tr>\n                        <tr>\n                            \n                                <td/>\n                                <td>\n                                    <pre class=\"highlight language-cql\"><code class=\"language-cql\">/*\nMeasure observation is a function defined in terms of the types of members of the measure\npopulation, Patient in this case. In a population evaluation scenario, the measure\nobservation is evaluated for every member of the population.\n\nIn an individual report scenario, however, the measure observation is evaluated for\nthe current patient. Note that the patient context is flowing through the call here\n*/\ndefine function &quot;MeasureObservation&quot;(patient Patient):\n  PHQ9Logic.CalculateTotalScore</code></pre>\n                                </td>\n                            \n                        </tr>\n                    \n                        <tr>\n                            <th><b>Library Name</b></th>\n                            <th><b>Name</b></th>\n                        </tr>\n                        <tr>\n                            \n                                <td>FHIRHelpers</td>\n                            \n                            \n                                <td>ToString</td>\n                            \n                        </tr>\n                        <tr>\n                            \n                                <td/>\n                                <td>\n                                    <pre class=\"highlight language-cql\"><code class=\"language-cql\">define function ToString(value string): value.value</code></pre>\n                                </td>\n                            \n                        </tr>\n                    \n                        <tr>\n                            <th><b>Library Name</b></th>\n                            <th><b>Name</b></th>\n                        </tr>\n                        <tr>\n                            \n                                <td>PHQ9ScoreLogic</td>\n                            \n                            \n                                <td>AnswerCardinality</td>\n                            \n                        </tr>\n                        <tr>\n                            \n                                <td/>\n                                <td>\n                                    <pre class=\"highlight language-cql\"><code class=\"language-cql\">/*\n@source: https://www.med.umich.edu/1info/FHP/practiceguides/depress/score.pdf\n*/\ndefine function &quot;AnswerCardinality&quot;(answer Coding):\n  case\n    when answer ~ &quot;Not at all&quot; then 0\n    when answer ~ &quot;Several days&quot; then 1\n    when answer ~ &quot;More than half the days&quot; then 2\n    when answer ~ &quot;Nearly every day&quot; then 3\n    else null\n  end</code></pre>\n                                </td>\n                            \n                        </tr>\n                    \n                        <tr>\n                            <th><b>Library Name</b></th>\n                            <th><b>Name</b></th>\n                        </tr>\n                        <tr>\n                            \n                                <td>FHIRHelpers</td>\n                            \n                            \n                                <td>ToCode</td>\n                            \n                        </tr>\n                        <tr>\n                            \n                                <td/>\n                                <td>\n                                    <pre class=\"highlight language-cql\"><code class=\"language-cql\">define function ToCode(coding FHIR.Coding):\n    if coding is null then\n        null\n    else\n        System.Code {\n          code: coding.code.value,\n          system: coding.system.value,\n          version: coding.version.value,\n          display: coding.display.value\n        }</code></pre>\n                                </td>\n                            \n                        </tr>\n                    \n                    </table>\n                </td>\n            </tr>\n            \n        \n    \n\n    </table>\n</div>"
  ] ; # 
  fhir:contained ( [
     a fhir:Library ;
     fhir:id [ fhir:v "effective-data-requirements" ] ;
     fhir:extension ( [
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-directReferenceCode"^^xsd:anyURI ] ;
       fhir:value [
         a fhir:Coding, loinc:LA6568-5 ;
         fhir:system [ fhir:v "http://loinc.org"^^xsd:anyURI ] ;
         fhir:code [ fhir:v "LA6568-5" ]
       ]
     ] [
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-directReferenceCode"^^xsd:anyURI ] ;
       fhir:value [
         a fhir:Coding, loinc:LA6569-3 ;
         fhir:system [ fhir:v "http://loinc.org"^^xsd:anyURI ] ;
         fhir:code [ fhir:v "LA6569-3" ]
       ]
     ] [
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-directReferenceCode"^^xsd:anyURI ] ;
       fhir:value [
         a fhir:Coding, loinc:LA6570-1 ;
         fhir:system [ fhir:v "http://loinc.org"^^xsd:anyURI ] ;
         fhir:code [ fhir:v "LA6570-1" ]
       ]
     ] [
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-directReferenceCode"^^xsd:anyURI ] ;
       fhir:value [
         a fhir:Coding, loinc:LA6571-9 ;
         fhir:system [ fhir:v "http://loinc.org"^^xsd:anyURI ] ;
         fhir:code [ fhir:v "LA6571-9" ]
       ]
     ] [
       fhir:extension ( [
         fhir:url [ fhir:v "libraryName"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "PHQ9ScoreLogic" ]
       ] [
         fhir:url [ fhir:v "name"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "QuestionnaireResponse" ]
       ] [
         fhir:url [ fhir:v "statement"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "// Use the QuestionnaireResponse provided as a parameter if available\n// Otherwise look it up from the record\ndefine \"QuestionnaireResponse\":\n  if response is not null then\n    response\n  else\n    Last(\n      [QuestionnaireResponse] QR\n        where QR.questionnaire = 'http://loinc.org/q/44249-1'\n        sort by (authored as FHIR.dateTime) desc\n    )" ]
       ] [
         fhir:url [ fhir:v "displaySequence"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "0"^^xsd:integer ]
       ] ) ;
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition"^^xsd:anyURI ]
     ] [
       fhir:extension ( [
         fhir:url [ fhir:v "libraryName"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "PHQ9ScoreLogic" ]
       ] [
         fhir:url [ fhir:v "name"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "Responses" ]
       ] [
         fhir:url [ fhir:v "statement"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "// NOTE: This ties this logic directly to this particular rendering of the Questionnaire.\n// Ideally the items would be filtered based on Code of the Item, rather than the LinkId,\n// but that would require pulling in the Questionnaire because the QuestionnaireResponse\n// only has the LinkId.\ndefine \"Responses\":\n  \"QuestionnaireResponse\" QR\n    return QR.item I where I.linkId in {\n      '14363', //'LittleInterest'\n      '14364', //'FeelingDown'\n      '14365', //'TroubleSleeping'\n      '14366', //'FeelingTired'\n      '14367', //'BadApetite'\n      '14368', //'FeelingBadAboutSelf'\n      '14369', //'TroubleConcetrating'\n      '14370' //'MovingSpeaking'\n      // '14371' // HurtingSelf\n    }" ]
       ] [
         fhir:url [ fhir:v "displaySequence"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "1"^^xsd:integer ]
       ] ) ;
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition"^^xsd:anyURI ]
     ] [
       fhir:extension ( [
         fhir:url [ fhir:v "libraryName"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "PHQ9ScoreLogic" ]
       ] [
         fhir:url [ fhir:v "name"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "CalculateTotalScore" ]
       ] [
         fhir:url [ fhir:v "statement"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "define \"CalculateTotalScore\":\n  Sum(\"Responses\" R return all AnswerCardinality(First(R.answer.value)))" ]
       ] [
         fhir:url [ fhir:v "displaySequence"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "2"^^xsd:integer ]
       ] ) ;
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition"^^xsd:anyURI ]
     ] [
       fhir:extension ( [
         fhir:url [ fhir:v "libraryName"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "PHQ9MeasureExample" ]
       ] [
         fhir:url [ fhir:v "name"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "Initial Population" ]
       ] [
         fhir:url [ fhir:v "statement"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "define \"Initial Population\":\n  AgeInYearsAt(start of \"Measurement Period\") >= 18" ]
       ] [
         fhir:url [ fhir:v "displaySequence"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "3"^^xsd:integer ]
       ] ) ;
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition"^^xsd:anyURI ]
     ] [
       fhir:extension ( [
         fhir:url [ fhir:v "libraryName"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "PHQ9MeasureExample" ]
       ] [
         fhir:url [ fhir:v "name"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "Measure Population" ]
       ] [
         fhir:url [ fhir:v "statement"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "// Likely some condition or other relevant characteristic such as a depression diagnosis\ndefine \"Measure Population\":\n  true" ]
       ] [
         fhir:url [ fhir:v "displaySequence"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "4"^^xsd:integer ]
       ] ) ;
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition"^^xsd:anyURI ]
     ] [
       fhir:extension ( [
         fhir:url [ fhir:v "libraryName"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "PHQ9MeasureExample" ]
       ] [
         fhir:url [ fhir:v "name"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "MeasureObservation" ]
       ] [
         fhir:url [ fhir:v "statement"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "/*\nMeasure observation is a function defined in terms of the types of members of the measure\npopulation, Patient in this case. In a population evaluation scenario, the measure\nobservation is evaluated for every member of the population.\n\nIn an individual report scenario, however, the measure observation is evaluated for\nthe current patient. Note that the patient context is flowing through the call here\n*/\ndefine function \"MeasureObservation\"(patient Patient):\n  PHQ9Logic.CalculateTotalScore" ]
       ] [
         fhir:url [ fhir:v "displaySequence"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "5"^^xsd:integer ]
       ] ) ;
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition"^^xsd:anyURI ]
     ] [
       fhir:extension ( [
         fhir:url [ fhir:v "libraryName"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "FHIRHelpers" ]
       ] [
         fhir:url [ fhir:v "name"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "ToString" ]
       ] [
         fhir:url [ fhir:v "statement"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "define function ToString(value string): value.value" ]
       ] [
         fhir:url [ fhir:v "displaySequence"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "6"^^xsd:integer ]
       ] ) ;
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition"^^xsd:anyURI ]
     ] [
       fhir:extension ( [
         fhir:url [ fhir:v "libraryName"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "PHQ9ScoreLogic" ]
       ] [
         fhir:url [ fhir:v "name"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "AnswerCardinality" ]
       ] [
         fhir:url [ fhir:v "statement"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "/*\n@source: https://www.med.umich.edu/1info/FHP/practiceguides/depress/score.pdf\n*/\ndefine function \"AnswerCardinality\"(answer Coding):\n  case\n    when answer ~ \"Not at all\" then 0\n    when answer ~ \"Several days\" then 1\n    when answer ~ \"More than half the days\" then 2\n    when answer ~ \"Nearly every day\" then 3\n    else null\n  end" ]
       ] [
         fhir:url [ fhir:v "displaySequence"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "7"^^xsd:integer ]
       ] ) ;
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition"^^xsd:anyURI ]
     ] [
       fhir:extension ( [
         fhir:url [ fhir:v "libraryName"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "FHIRHelpers" ]
       ] [
         fhir:url [ fhir:v "name"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "ToCode" ]
       ] [
         fhir:url [ fhir:v "statement"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "define function ToCode(coding FHIR.Coding):\n    if coding is null then\n        null\n    else\n        System.Code {\n          code: coding.code.value,\n          system: coding.system.value,\n          version: coding.version.value,\n          display: coding.display.value\n        }" ]
       ] [
         fhir:url [ fhir:v "displaySequence"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "8"^^xsd:integer ]
       ] ) ;
       fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition"^^xsd:anyURI ]
     ] ) ;
     fhir:name [ fhir:v "EffectiveDataRequirements" ] ;
     fhir:status [ fhir:v "active" ] ;
     fhir:type [
       fhir:coding ( [
         fhir:system [ fhir:v "http://terminology.hl7.org/CodeSystem/library-type"^^xsd:anyURI ] ;
         fhir:code [ fhir:v "module-definition" ]
       ] )
     ] ;
     fhir:relatedArtifact ( [
       fhir:type [ fhir:v "depends-on" ] ;
       fhir:display [ fhir:v "Library PHQ9Logic" ] ;
       fhir:resource [
         fhir:v "http://mtnlotus.com/uv/pco/Library/PHQ9ScoreLogic"^^xsd:anyURI ;
         fhir:link <http://mtnlotus.com/uv/pco/Library/PHQ9ScoreLogic>
       ]
     ] [
       fhir:type [ fhir:v "depends-on" ] ;
       fhir:display [ fhir:v "Library FHIRHelpers" ] ;
       fhir:resource [
         fhir:v "http://mtnlotus.com/uv/pco/Library/FHIRHelpers|4.0.1"^^xsd:anyURI ;
         fhir:link <http://mtnlotus.com/uv/pco/Library/FHIRHelpers|4.0.1>
       ]
     ] [
       fhir:type [ fhir:v "depends-on" ] ;
       fhir:display [ fhir:v "Code system LOINC" ] ;
       fhir:resource [
         fhir:v "http://loinc.org"^^xsd:anyURI ;
         fhir:link <http://loinc.org>
       ]
     ] ) ;
     fhir:parameter ( [
       fhir:name [ fhir:v "Measurement Period" ] ;
       fhir:use [ fhir:v "in" ] ;
       fhir:min [ fhir:v "0"^^xsd:integer ] ;
       fhir:max [ fhir:v "1" ] ;
       fhir:type [ fhir:v "Period" ]
     ] [
       fhir:name [ fhir:v "Initial Population" ] ;
       fhir:use [ fhir:v "out" ] ;
       fhir:min [ fhir:v "0"^^xsd:integer ] ;
       fhir:max [ fhir:v "1" ] ;
       fhir:type [ fhir:v "boolean" ]
     ] [
       fhir:name [ fhir:v "Measure Population" ] ;
       fhir:use [ fhir:v "out" ] ;
       fhir:min [ fhir:v "0"^^xsd:integer ] ;
       fhir:max [ fhir:v "1" ] ;
       fhir:type [ fhir:v "boolean" ]
     ] ) ;
     fhir:dataRequirement ( [
       fhir:type [ fhir:v "Patient" ] ;
       fhir:profile ( [
         fhir:v "http://hl7.org/fhir/StructureDefinition/Patient"^^xsd:anyURI ;
         fhir:link <http://hl7.org/fhir/StructureDefinition/Patient>
       ] )
     ] )
  ] ) ; # 
  fhir:extension ( [
     fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-softwaresystem"^^xsd:anyURI ] ;
     fhir:value [
       a fhir:Reference ;
       fhir:link <http://mtnlotus.com/uv/pco/Device/cqf-tooling> ;
       fhir:reference [ fhir:v "Device/cqf-tooling" ]
     ]
  ] [
     fhir:id [ fhir:v "effective-data-requirements" ] ;
     fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-effectiveDataRequirements"^^xsd:anyURI ] ;
     fhir:value [
       a fhir:Reference ;
       fhir:reference [ fhir:v "#effective-data-requirements" ]
     ]
  ] ) ; # 
  fhir:url [ fhir:v "http://mtnlotus.com/uv/pco/Measure/PHQ9MeasureExample"^^xsd:anyURI] ; # 
  fhir:version [ fhir:v "0.1.0"] ; # 
  fhir:name [ fhir:v "PHQ9MeasureExample"] ; # 
  fhir:title [ fhir:v "PHQ-9 Measure Example"] ; # 
  fhir:status [ fhir:v "draft"] ; # 
  fhir:experimental [ fhir:v "true"^^xsd:boolean] ; # 
  fhir:date [ fhir:v "2024-08-06T11:23:14-07:00"^^xsd:dateTime] ; # 
  fhir:publisher [ fhir:v "Mountain Lotus WellBeing LLC"] ; # 
  fhir:contact ( [
     fhir:name [ fhir:v "Mountain Lotus WellBeing LLC" ] ;
     fhir:telecom ( [
       fhir:system [ fhir:v "url" ] ;
       fhir:value [ fhir:v "http://mtnlotus.com" ]
     ] )
  ] ) ; # 
  fhir:description [ fhir:v "Example measure illustrating a continuous variable measure calculating scores from multiple questionnaires"] ; # 
  fhir:jurisdiction ( [
     fhir:coding ( [
       fhir:system [ fhir:v "http://unstats.un.org/unsd/methods/m49/m49.htm"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "001" ] ;
       fhir:display [ fhir:v "World" ]
     ] )
  ] ) ; # 
  fhir:library ( [
     fhir:v "http://mtnlotus.com/uv/pco/Library/PHQ9MeasureExample"^^xsd:anyURI ;
     fhir:link <http://mtnlotus.com/uv/pco/Library/PHQ9MeasureExample>
  ] ) ; # 
  fhir:scoring [
     fhir:coding ( [
       fhir:system [ fhir:v "http://terminology.hl7.org/CodeSystem/measure-scoring"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "continuous-variable" ] ;
       fhir:display [ fhir:v "Continuous Variable" ]
     ] )
  ] ; # 
  fhir:type ( [
     fhir:coding ( [
       fhir:system [ fhir:v "http://terminology.hl7.org/CodeSystem/measure-type"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "process" ]
     ] )
  ] ) ; # 
  fhir:improvementNotation [
     fhir:coding ( [
       fhir:system [ fhir:v "http://terminology.hl7.org/CodeSystem/measure-improvement-notation"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "increase" ]
     ] )
  ] ; # 
  fhir:group ( [
     fhir:id [ fhir:v "group-1" ] ;
     fhir:population ( [
       fhir:id [ fhir:v "8A48538B-80BB-4E8B-9716-559C657278FD" ] ;
       fhir:code [
         fhir:coding ( [
           fhir:system [ fhir:v "http://terminology.hl7.org/CodeSystem/measure-population"^^xsd:anyURI ] ;
           fhir:code [ fhir:v "initial-population" ] ;
           fhir:display [ fhir:v "Initial Population" ]
         ] )
       ] ;
       fhir:criteria [
         fhir:language [ fhir:v "text/cql-identifier" ] ;
         fhir:expression [ fhir:v "Initial Population" ]
       ]
     ] [
       fhir:id [ fhir:v "8FBD6CFA-99E4-4108-B083-91067C55170E" ] ;
       fhir:code [
         fhir:coding ( [
           fhir:system [ fhir:v "http://terminology.hl7.org/CodeSystem/measure-population"^^xsd:anyURI ] ;
           fhir:code [ fhir:v "measure-population" ] ;
           fhir:display [ fhir:v "Measure Population" ]
         ] )
       ] ;
       fhir:criteria [
         fhir:language [ fhir:v "text/cql-identifier" ] ;
         fhir:expression [ fhir:v "Measure Population" ]
       ]
     ] [
       fhir:id [ fhir:v "8B71AD15-47EB-4939-8318-1DF60CABCFD6" ] ;
       fhir:extension ( [
         fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-aggregateMethod"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "average" ]
       ] [
         fhir:url [ fhir:v "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-criteriaReference"^^xsd:anyURI ] ;
         fhir:value [ fhir:v "8FBD6CFA-99E4-4108-B083-91067C55170E" ]
       ] ) ;
       fhir:code [
         fhir:coding ( [
           fhir:system [ fhir:v "http://terminology.hl7.org/CodeSystem/measure-population"^^xsd:anyURI ] ;
           fhir:code [ fhir:v "measure-observation" ] ;
           fhir:display [ fhir:v "Measure Observation" ]
         ] )
       ] ;
       fhir:criteria [
         fhir:language [ fhir:v "text/cql-identifier" ] ;
         fhir:expression [ fhir:v "MeasureObservation" ]
       ]
     ] )
  ] ) . # 

# -------------------------------------------------------------------------------------

